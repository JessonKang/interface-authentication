# interface-authentication

## 1.描述

&emsp;微服务通过http协议暴露接口给其它系统调用，为了保证接口调用的安全性，需要设计一个接口调用鉴权功能，只有经过鉴权成功的系统才能调用服务端的接口，鉴权失败的系统调用请求会被服务端拒绝。



## 2.需求分析（OOA）

&emsp;该项目主要涉及到的是客户端与服务端之间的请求和鉴权，因此基于两端的工作内容来做需求分析。

1. 调用方进行接口请求的时候，将URL、AppID、密码、时间戳拼接在一起，通过加密算法生成token，并且将token、AppID、时间戳拼接在URL中，一并发送到微服务端。
2. 微服务端在接收到调用方的接口请求之后，从请求中拆解出token、AppID、时间戳。
3. 微服务端首先检查传递过来的时间戳跟当前时间，判断是否在token失效窗口时间内。如果超过失效时间，那就算接口调用鉴权失败，拒绝接口调用请求。
4. 如果请求没有过期，微服务端再从自己的存储中，取出AppID对应的密码，通过同样的token生成算法，生成另外一个token，与调用方传递过来的token进行匹配，如果一致，则鉴权成功，允许接口调用，否则鉴权失败，拒绝接口调用。



## 3.面向对象设计（OOD）

&emsp;基于需求分析来划分职责，进而识别出有哪些类。通过上面的需求分析，创建3个核心的类，分别是AuthToken、URL和CredentialStorage。

#### （1）AuthToken类的功能

- 把URL、AppID、密码、时间戳拼接为一个字符串；

- 对字符串通过加密算法生成token；

- 根据时间戳判断token是否过期失效；

- 验证两个token是否匹配。

  

#### （2）URL类的功能

- 将token、AppID、时间戳拼接到URL中，形成新的URL；
- 解析URL，得到token、AppID、时间戳等信息。



#### （3）CredentialStorage类的功能

- 从存储中取出AppID和对应的密码。